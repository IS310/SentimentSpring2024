---
title: "Sentiment5"
output: html_document
date: "2024-04-18"
---

```{r}
library(tidytext)
library(textdata)

# Create a function for looking up AFINN sentiment values from words
Sents <- get_sentiments("afinn")
SVal <- Sents$value
names(SVal) <- Sents$word
SVF <- function(x){return(as.integer(SVal[x]))}

# Sample comment

# Read Jane Eyre into chapter-size chunks of text
JaneSentimentByChapter <- c() # start with an empty vector 
text.v <- scan("https://www.gutenberg.org/files/1260/1260-0.txt", what="character", sep="\n")
start.v <- (grep("\\*\\*\\*\\W*START OF TH",text.v) + 1)
end.v <- (grep("\\*\\*\\*\\W*END OF TH",text.v) - 1)
novel.lines.v <- text.v[start.v:end.v]                              # 1 element per line
novel.v <- paste(novel.lines.v, collapse="<br>")                    # linebreaks become tags
novel.lower.v <- tolower(novel.v)
jane.chap.l <- strsplit(novel.lower.v, "<br>chapter [ivx]+(â€”conclusion)?<br>")    # split at chapter breaks
jane.chap.v <- unlist(jane.chap.l)                                  # 1 element per chapter



# Loop over the chapters, split them into words, and lookup the AFINN values.
for(i in 6:10) {    
  chapteri <- jane.chap.v[i]
  chapterlist <- strsplit(chapteri,"\\W")
  chapterv <- unlist(chapterlist)
  baz <- SVF(chapterv)            # sentiment values for every word
  buz <- chapterv[which(baz!="NA")]    # but many words aren't in AFINN: select those that are.
  Htitle <- paste("chapter",(i - 1),sep="")
  assign(Htitle,buz[1:199])
  
}

someWords <- data.frame(chapter5,chapter6,chapter7,chapter8,chapter9)

knitr::kable(someWords[1:199,1:5], format="markdown")

```

